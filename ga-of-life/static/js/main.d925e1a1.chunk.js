(this["webpackJsonpga-of-life"]=this["webpackJsonpga-of-life"]||[]).push([[0],{20:function(e,t,n){var c=n(30),a=["init","reset","step"];e.exports=function(){var e=new Worker(n.p+"187bf5893db117a58a59.worker.js",{name:"[hash].worker.js"});return c(e,a),e}},25:function(e,t,n){},26:function(e,t,n){},31:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),i=n(19),s=n.n(i),l=(n(25),n(3)),r=(n(26),n(2)),o=n(11),j=n(5),u=n(16),d=n(0),h=n(18);n(28)(h);function b(e){var t=e.eaState,n=Object(c.useState)([]),a=Object(l.a)(n,2),i=a[0],s=a[1],r=Object(c.useState)(),o=Object(l.a)(r,2),j=o[0],b=o[1],f=function(){b(h.chart("ea-graph",{title:{text:"Evolutionary Algorithm"},yAxis:[{title:{text:"Fitness"}},{title:{text:"Evaluations"},opposite:!0}],series:[{name:"Max. fitness",type:"line",marker:{enabled:!1},data:[]},{name:"Num. evaluations",type:"line",marker:{enabled:!1},yAxis:1,data:[]}]}))};return Object(c.useEffect)((function(){var e;if(j)if(t){if((null===t||void 0===t?void 0:t.generations)!==(null===(e=i[i.length-1])||void 0===e?void 0:e.generations)){var n=!1;i.length<250?s([].concat(Object(u.a)(i),[t])):(s([].concat(Object(u.a)(i.slice(1,250)),[t])),n=!0),j.series[0].addPoint([t.generations,t.maxFitness],!0,n),j.series[1].addPoint([t.generations,t.evaluationsDelta],!0,n)}}else i.length>0&&(s([]),j.destroy(),f())}),[t,i,j]),Object(c.useEffect)((function(){f()}),[]),Object(d.jsx)("div",{id:"ea-graph",style:{height:"400px",width:"100%"}})}var f=n(17),O=n(10),x=n.n(O),v=n(13),p=n(7),m=n(20),g=n.n(m);function S(e){var t=e.onStep,n=Object(c.useState)(!1),a=Object(l.a)(n,2),i=a[0],s=a[1],r=Object(c.useState)(!1),o=Object(l.a)(r,2),j=o[0],u=o[1],h=Object(c.useState)(!1),b=Object(l.a)(h,2),O=b[0],m=b[1],S=Object(c.useState)(),y=Object(l.a)(S,2),w=y[0],N=y[1],C=Object(c.useState)(0),k=Object(l.a)(C,2),M=k[0],E=k[1];return Object(c.useEffect)((function(){function e(){return(e=Object(v.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.info("Setting worker"),t=new g.a,e.next=4,t.init();case 4:N(t);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}if(w)return function(){w.terminate()};!function(){e.apply(this,arguments)}()}),[w,N]),Object(c.useEffect)((function(){if(!j&&(O||i)){m(!1),u(!0);var e=(new Date).getTime();w.step().then((function(n){var c=(new Date).getTime(),a=M+(c-e);u(!1),E((function(t){return t+(c-e)})),null===t||void 0===t||t(Object(f.a)(Object(f.a)({},n),{},{runTime:Math.round(a/1e3)}))}))}}),[j,O,i,w,M,t]),Object(d.jsxs)("div",{children:[Object(d.jsx)(p.a,{onClick:function(){w.reset(),E(0),null===t||void 0===t||t(null)},disabled:j||i,children:"Reset"}),Object(d.jsx)(p.a,{onClick:function(){s(!0)},disabled:j||i,children:"Run"}),Object(d.jsx)(p.a,{onClick:function(){s(!1)},disabled:!i,children:"Pause"}),Object(d.jsx)(p.a,{onClick:function(){m(!0)},disabled:j||i,children:"Step"})]})}function y(e){var t=e.eaState;return t&&Object(d.jsxs)(o.a,{children:[Object(d.jsxs)(j.a,{children:[Object(d.jsx)(r.a,{className:"Label",xs:8,children:"Num. generations"}),Object(d.jsx)(r.a,{className:"NumValue",xs:4,children:t.generations})]}),Object(d.jsxs)(j.a,{children:[Object(d.jsx)(r.a,{className:"Label",xs:8,children:"Num. evaluations"}),Object(d.jsx)(r.a,{className:"NumValue",xs:4,children:t.evaluations})]}),Object(d.jsxs)(j.a,{children:[Object(d.jsx)(r.a,{className:"Label",xs:8,children:"Num. CA steps"}),Object(d.jsx)(r.a,{className:"NumValue",xs:4,children:t.caSteps})]}),Object(d.jsxs)(j.a,{children:[Object(d.jsx)(r.a,{className:"Label",xs:8,children:"Max. fitness"}),Object(d.jsx)(r.a,{className:"NumValue",xs:4,children:t.maxFitness})]}),Object(d.jsxs)(j.a,{children:[Object(d.jsx)(r.a,{className:"Label",xs:8,children:"Run time [s]"}),Object(d.jsx)(r.a,{className:"NumValue",xs:4,children:t.runTime})]}),Object(d.jsxs)(j.a,{children:[Object(d.jsxs)(r.a,{className:"Label",xs:8,children:["CA steps [s",Object(d.jsx)("sup",{children:"-1"}),"]"]}),Object(d.jsx)(r.a,{className:"NumValue",xs:4,children:t.runTime>0?Math.round(t.caSteps/t.runTime):"-"})]})]})||null}var w,N=64;function C(){return k.apply(this,arguments)}function k(){return(k=Object(v.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w){e.next=5;break}return e.next=3,n.e(3).then(n.bind(null,39));case 3:t=e.sent,w=new t.GameOfLife(N,N);case 5:return e.abrupt("return",w);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e,t,n){e.beginPath();for(var c=0;c<N;c++)for(var a=0;a<N;a++)t.get(a,c)?e.fillStyle="#000000":n[a+c*N]?e.fillStyle="#A0A0A0":e.fillStyle="#FFFFFF",e.fillRect(5*a+1,5*c+1,4,4);e.stroke()}function E(){return document.getElementById("ca-canvas").getContext("2d")}function z(e,t){e.step(),function(e,t){for(var n=0;n<N;n++)for(var c=0;c<N;c++)e.get(c,n)&&(t[c+n*N]=!0)}(e,t),M(E(),e,t)}function A(e){var t=e.seed,n=Object(c.useState)(),a=Object(l.a)(n,2),i=a[0],s=a[1],u=Object(c.useState)(new Array(4096)),h=Object(l.a)(u,2),b=h[0],f=(h[1],Object(c.useState)()),O=Object(l.a)(f,2),m=O[0],g=O[1],S=Object(c.useState)(0),y=Object(l.a)(S,2),w=y[0],k=y[1],A=function(){g(!m)};return Object(c.useEffect)((function(){function e(){return(e=Object(v.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.info("Loading CA wasm"),e.t0=s,e.next=4,C();case 4:e.t1=e.sent,(0,e.t0)(e.t1);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}i?function(e){e.beginPath(),e.strokeStyle="#CCCCCC";for(var t=0;t<=N;t++)e.moveTo(5*t+1,0),e.lineTo(5*t+1,321);for(var n=0;n<=N;n++)e.moveTo(0,5*n+1),e.lineTo(321,5*n+1);e.stroke()}(E()):function(){e.apply(this,arguments)}()}),[i,b]),Object(c.useEffect)((function(){if(m){var e=setTimeout((function(){z(i,b),k(w+1)}),10);return function(){clearTimeout(e)}}})),Object(d.jsxs)(o.a,{children:[Object(d.jsx)(j.a,{children:Object(d.jsxs)(r.a,{children:[Object(d.jsx)(p.a,{onClick:function(){b.forEach((function(e,t,n){n[t]=0})),function(e,t){e.reset();for(var n=0;n<8;n++)for(var c=0;c<8;c++)"0"!==t.charAt(n+8*c)&&e.set(n+28,c+28)}(i,t),M(E(),i,b)},disabled:!i||m,children:"Seed"}),Object(d.jsx)(p.a,{onClick:A,disabled:!i||m,children:"Play"}),Object(d.jsx)(p.a,{onClick:A,disabled:!(i&&m),children:"Pause"}),Object(d.jsx)(p.a,{onClick:function(){z(i,b)},disabled:!i||m,children:"Step"})]})}),Object(d.jsx)(j.a,{children:Object(d.jsx)(r.a,{children:Object(d.jsx)("canvas",{id:"ca-canvas",width:320,height:320})})})]})}function T(e){var t=Math.min(1,Math.max(0,Number(e)));return"rgb(".concat(255*(1-t),", ").concat(255*t,", 0)")}function F(e){var t=e.genotype,n=e.plotId,a=Object(c.useState)(),i=Object(l.a)(a,2),s=i[0],r=i[1];return Object(c.useEffect)((function(){var e=document.getElementById(n);if(e.width!==(null===s||void 0===s?void 0:s.canvasWidth)){var t=e.width-27,c=e.height-41,a=Math.floor(t/8),i=Math.floor(c/10),l=Math.min(i,a),o=Math.floor((l-1)/2),j=2*o+1,u=27+8*j,d=41+10*j,h={canvasWidth:e.width,cellSize:o,x0:Math.floor((e.width-u)/2),y0:Math.floor((e.height-d)/2),width:u,height:d};console.info({w:e.width,h:e.height,horizontalCellSpace:t,verticalCellSpace:c,bigCellSize:j}),console.info("Plot settings:",h),r(h)}}),[s,n]),Object(c.useEffect)((function(){if(s){var e=document.getElementById(n).getContext("2d");t?function(e,t,n){for(var c=0,a=0,i=0,s=2*t.cellSize+1;c<16;)e.fillStyle=T(n[c]),e.fillRect(a+t.x0+3,i+t.y0+3,s,s),(c+=1)%8===0?(a=0,i+=s+3):a+=s+3;i+=8;for(var l=function(c,a,i){e.fillStyle=T(n[c]),e.fillRect(a+t.x0+3,i+t.y0+3,t.cellSize,t.cellSize)},r=0;c<n.length;)l(c,a,i),l(c+1,a+t.cellSize+1,i),l(c+2,a,i+t.cellSize+1),l(c+3,a+t.cellSize+1,i+t.cellSize+1),c+=4,(r+=1)%8===0?(a=0,i+=s+3):a+=s+3}(e,s,t):function(e,t){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="#A0A0A0",e.fillRect(t.x0,t.y0,t.width,t.height)}(e,s)}}),[s,n,t]),Object(d.jsx)("div",{className:"plot-container",children:Object(d.jsx)("canvas",{className:"plot",id:n,height:200})})}function I(e){var t=255*(1-Math.min(1,Math.max(0,Number(e))));return"rgb(".concat(t,", ").concat(t,", ").concat(t,")")}function P(e){var t=e.phenotype,n=e.plotId,a=Object(c.useState)(),i=Object(l.a)(a,2),s=i[0],r=i[1];return Object(c.useEffect)((function(){if(!s){var e=document.getElementById(n),t=e.width-21,c=e.height-21,a=Math.floor(t/8),i=Math.floor(c/8),l=Math.min(i,a),o=21+8*l,j=21+8*l,u={cellSize:l,x0:Math.floor((e.width-o)/2),y0:Math.floor((e.height-j)/2),width:o,height:j};console.info("Plot settings:",u),r(u)}}),[s,n]),Object(c.useEffect)((function(){if(s){var e=document.getElementById(n).getContext("2d");t?function(e,t,n){for(var c=0,a=0,i=0;c<n.length;)e.fillStyle=I(n[c]),e.fillRect(a+t.x0,i+t.y0,t.cellSize,t.cellSize),(c+=1)%8===0?(a=0,i+=t.cellSize+3):a+=t.cellSize+3}(e,s,t):function(e,t){e.clearRect(0,0,e.canvas.width,e.canvas.height)}(e)}}),[s,n,t]),Object(d.jsx)("div",{className:"plot-container",children:Object(d.jsx)("canvas",{className:"plot",id:n,height:200})})}var L=function(){var e=Object(c.useState)(),t=Object(l.a)(e,2),n=t[0],a=t[1];return Object(d.jsxs)("div",{className:"App",children:[Object(d.jsxs)(o.a,{children:[Object(d.jsxs)(j.a,{children:[Object(d.jsx)(r.a,{lg:4,xs:6,children:Object(d.jsxs)(o.a,{children:[Object(d.jsx)(j.a,{children:Object(d.jsx)(r.a,{children:Object(d.jsx)(S,{onStep:a})})}),Object(d.jsx)(j.a,{children:Object(d.jsx)(y,{eaState:n})})]})}),Object(d.jsx)(r.a,{lg:8,xs:12,children:Object(d.jsx)(b,{eaState:n})})]}),Object(d.jsxs)(j.a,{children:[Object(d.jsxs)(r.a,{lg:3,children:[Object(d.jsx)("h3",{children:"Gene distribution"}),Object(d.jsx)(F,{genotype:null===n||void 0===n?void 0:n.geneDistribution,plotId:"gene-distribution"})]}),Object(d.jsxs)(r.a,{lg:3,children:[Object(d.jsx)("h3",{children:"Best genotype"}),Object(d.jsx)(F,{genotype:null===n||void 0===n?void 0:n.bestGenotype,plotId:"best-genotype"})]}),Object(d.jsxs)(r.a,{lg:3,children:[Object(d.jsx)("h3",{children:"Cell distribution"}),Object(d.jsx)(P,{phenotype:null===n||void 0===n?void 0:n.cellDistribution,plotId:"cell-distribution"})]}),Object(d.jsxs)(r.a,{lg:3,children:[Object(d.jsx)("h3",{children:"Best phenotype"}),Object(d.jsx)(P,{phenotype:null===n||void 0===n?void 0:n.bestPhenotype,plotId:"best-phenotype"})]})]})]}),Object(d.jsx)(A,{seed:null===n||void 0===n?void 0:n.bestPhenotype})]})},R=function(e){e&&e instanceof Function&&n.e(4).then(n.bind(null,40)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,i=t.getLCP,s=t.getTTFB;n(e),c(e),a(e),i(e),s(e)}))};s.a.render(Object(d.jsx)(a.a.StrictMode,{children:Object(d.jsx)(L,{})}),document.getElementById("root")),R()}},[[31,1,2]]]);
//# sourceMappingURL=main.d925e1a1.chunk.js.map